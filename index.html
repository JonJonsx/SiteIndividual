<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <title>Site institucional individual</title>
</head>

<body>
    <header class="header container" id="header">
        <div class="container">
            <div>
                <h1 class="titulo">Site</h1>
            </div>
            <nav>
                <ul class="menu">
                    <li><a href="">Home</a></li>
                    <li><a href="">Sobre</a></li>
                    <li><a href="#batata">Contato</a></li>
                    <li class="submenu"><a href="pages/login.html"><i class="fa fa-user" aria-hidden="true"></i></a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <section class="section">
        <div class="container">
            <div class="read">
                <h1>Seja bem vindo</h1>
            </div>
            <div class="divSearch">
                <input type="text" id="txtSearch" class="txtSearch">
            </div>
            <div class="boxCard" id="boxCard">
            </div>
        </div>
    </section>
</body>

</html>
<!-- <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script> -->
<script src="js/index.js"></script>
<script src="https://kit.fontawesome.com/4d7d6b2306.js"></script>
<script type="module" src="./js/cards.js"></script>
<script type="module">
    import Pokemon from './js/Pokemon.js';
    import buildCard from './js/cards.js';

    var search = document.getElementById("txtSearch");
    var boxCard = document.getElementById("boxCard");
    search.addEventListener('keyup', (e) => {
        if (e.keyCode === 13) {
            clear();
            fnGetPoke(e.target.value);
        } else if (e.target.value == '') {
            clear();
            datapoke();
        }
    });
    const clear = () => { boxCard.innerHTML = ''; }

    function fnGetPoke(poke) {
        Pokemon.getPokemon(poke).then(data => {
            const pokemon = new Pokemon(data.id,
                data.name,
                data.sprites.front_default,
                data.height,
                data.weight,
                data.stats[5].base_stat,
                data.stats[4].base_stat,
                data.stats[3].base_stat,
                data.stats[2].base_stat,
                data.stats[1].base_stat,
                data.stats[0].base_stat,
                data.types
            );
            buildCard(pokemon);

            document.querySelectorAll('.card').forEach(item => {
                item.addEventListener('click', function (event, item) {
                    
                    const id = event.currentTarget.getElementsByClassName('read')[0].getElementsByTagName('label')[0].innerText
                    const formatado = id.split(" ")[1]
                    trocarPagina(formatado)
                })
            })
    });
    }

    function trocarPagina(id){
        location.href= `./pages/dataPoke.html?id=${+id}`;
        console.log("trocando de pagina" ,id);
    }

    const amountPoke = 20; // Quantidade de pokemon que vai aparecer na tela
    const datapoke = () => {
        for (var i = 1; i <= amountPoke; i++) {
            const numero = i;

            fnGetPoke(i);
        }
    }

    window.addEventListener('load', () => {
        datapoke();
    })

    var nImage = parseInt(Math.random() * 2) + 1;
    document.getElementsByTagName('body')[0].style.backgroundImage = `url(./img/img${nImage}.png)`;
</script>